// In your backend server (e.g., app.js)
app.post('/api/register', async (req, res) => {
    try {
        const {
            full_name,
            email,
            phone,
            password_hash,
            age,
            height_cm,
            weight_kg,
            blood_group,
            gender,
            address,
            chronic_diseases
        } = req.body;

        // Insert into users table
        const [result] = await db.promise().query(
            `INSERT INTO users 
            (full_name, email, phone, password_hash, age, height_cm, weight_kg, 
             blood_group, gender, address, chronic_diseases) 
            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,
            [
                full_name,
                email,
                phone,
                password_hash,
                age,
                height_cm,
                weight_kg,
                blood_group,
                gender,
                address,
                chronic_diseases
            ]
        );

        const userId = result.insertId;

        // Create default profile entry
        await db.promise().query(
            `INSERT INTO profiles (user_id) VALUES (?)`,
            [userId]
        );

        res.json({
            success: true,
            user_id: userId,
            message: 'Registration successful'
        });

    } catch (error) {
        console.error('Registration error:', error);
        
        // Handle duplicate email/phone
        if (error.code === 'ER_DUP_ENTRY') {
            return res.status(400).json({
                success: false,
                error: 'Email or phone number already registered'
            });
        }
        
        res.status(500).json({
            success: false,
            error: 'Registration failed'
        });
    }
});