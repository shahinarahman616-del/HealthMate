<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HealthMate - Profile</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>

  <body class="bg-gray-50 text-gray-800">
    <div id="root"></div>

    <script type="text/babel">
      // Set backend base URL
      const BASE_URL = window.location.hostname === 'localhost'
        ? 'http://localhost:5000'
        : 'https://healthmate-backend-m6xy.onrender.com';

      // Navbar component
      const Navbar = () => (
        <nav className="bg-white shadow-sm">
          <div className="max-w-6xl mx-auto flex justify-between items-center p-4">
            <div className="flex items-center gap-2">
              <span className="text-green-600 text-2xl font-bold">ðŸ’š</span>
              <h1 className="text-xl font-semibold text-gray-800">HealthMate</h1>
            </div>
            <ul className="flex gap-8 text-gray-700 font-medium">
              <li><a href="index.html" className="hover:text-green-600">Home</a></li>
              <li><a href="login.html" className="hover:text-green-600">Login</a></li>
              <li><a href="register.html" className="hover:text-green-600">Register</a></li>
            </ul>
          </div>
        </nav>
      );

      // Profile component
      const Profile = () => {
        const [profile, setProfile] = React.useState(null);

        React.useEffect(() => {
          fetchProfile();
        }, []);

        async function fetchProfile() {
          try {
            const res = await fetch(`${BASE_URL}/api/profile`, {
              method: 'GET',
              headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${localStorage.getItem('token')}` // if using token auth
              }
            });
            const data = await res.json();
            setProfile(data);
          } catch (err) {
            console.error('Error fetching profile:', err);
          }
        }

        if (!profile) {
          return <p className="text-center mt-10 text-gray-600">Loading profile...</p>;
        }

        return (
          <div className="max-w-3xl mx-auto bg-white shadow-md rounded-md p-8 mt-10">
            <h2 className="text-2xl font-bold mb-4">My Profile</h2>
            <p><strong>Name:</strong> {profile.name}</p>
            <p><strong>Email:</strong> {profile.email}</p>
            <p><strong>Phone:</strong> {profile.phone || 'N/A'}</p>
            <p><strong>Age:</strong> {profile.age || 'N/A'}</p>
          </div>
        );
      };

      // Main App
      const App = () => (
        <div>
          <Navbar />
          <Profile />
        </div>
      );

      // Render App
      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
